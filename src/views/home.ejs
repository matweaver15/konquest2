<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Kahnquest Home</title>
    <style>
      body { font-family: system-ui, sans-serif; margin: 0; padding: 2rem; background: linear-gradient(135deg, #e0e9ff, #f5f9ff); color: #1d2a44; }
      header { display: flex; align-items: center; justify-content: space-between; max-width: 960px; margin: 0 auto 2rem; }
      .brand { font-size: 1.6rem; font-weight: 700; }
      main { max-width: 960px; margin: 0 auto; background: #fff; padding: 2.5rem; border-radius: 16px; box-shadow: 0 20px 45px rgba(30, 50, 107, 0.15); }
      h1 { margin-top: 0; font-size: 2rem; }
      h2 { margin-bottom: 0.75rem; font-size: 1.4rem; }
      p { line-height: 1.6; }
      .cta { margin-top: 2rem; display: flex; gap: 1rem; flex-wrap: wrap; }
      .btn { display: inline-flex; align-items: center; justify-content: center; padding: 0.75rem 1.4rem; border-radius: 999px; border: none; font-size: 1rem; cursor: pointer; text-decoration: none; transition: transform 0.2s ease, box-shadow 0.2s ease; }
      .btn-primary { background: #2d5bff; color: #fff; box-shadow: 0 10px 24px rgba(45, 91, 255, 0.25); }
      .btn-primary:hover { transform: translateY(-1px); box-shadow: 0 14px 26px rgba(45, 91, 255, 0.3); }
      .btn-secondary { background: #f0f1f6; color: #313b4e; }
      form { margin: 0; }
      .keyword-card { margin-top: 2rem; padding: 1.5rem; border-radius: 16px; background: #f5f7ff; box-shadow: inset 0 0 0 1px rgba(45, 91, 255, 0.08); }
      .keyword-card form { display: flex; gap: 1rem; flex-wrap: wrap; align-items: center; }
      .keyword-card input { flex: 1 1 220px; padding: 0.75rem 1rem; font-size: 1rem; border-radius: 999px; border: 1px solid rgba(45, 91, 255, 0.35); }
      .feedback { margin-top: 1rem; padding: 0.75rem 1rem; border-radius: 12px; }
      .feedback.error { background: #ffecef; color: #7b001c; }
      .feedback.success { background: #e6f8f3; color: #0d5f3f; }
      .feedback.info { background: #e6eeff; color: #1b3a91; }
      .score { font-weight: 600; margin-top: 0.5rem; }
      .leaderboard-link { margin-top: 1.5rem; display: inline-flex; align-items: center; gap: 0.4rem; color: #2d5bff; text-decoration: none; font-weight: 600; }
      .leaderboard-link:hover { text-decoration: underline; }
    </style>
  </head>
  <body>
    <header>
      <div class="brand">Kahnquest</div>
      <% if (user) { %>
        <form method="post" action="/auth/logout">
          <button class="btn btn-secondary" type="submit">Log out</button>
        </form>
      <% } else { %>
        <div class="cta">
          <a class="btn btn-secondary" href="/auth/login">Log in</a>
          <a class="btn btn-primary" href="/auth/register">Create account</a>
        </div>
      <% } %>
    </header>

    <main>
      <% if (user) { %>
        <h1>Welcome back, <%= user.username %>!</h1>
        <p>Crack the hidden keywords to climb the leaderboard.</p>
        <p class="score">Current score: <%= user.score %> pts</p>

        <section class="keyword-card">
          <h2>Submit a keyword</h2>
          <p>Enter the secret word you've discovered. Each correct keyword can be redeemed once per player for <%= 100 %> points.</p>
          <form method="post" action="/submit-keyword" novalidate>
            <input
              type="text"
              name="keyword"
              value="<%= keywordState.value %>"
              autocomplete="off"
              placeholder="Enter keyword"
              required
              minlength="1"
            />
            <button class="btn btn-primary" type="submit">Redeem</button>
          </form>

          <% if (keywordState.errors.length) { %>
            <div class="feedback error">
              <ul>
                <% keywordState.errors.forEach(function (error) { %>
                  <li><%= error.msg %></li>
                <% }) %>
              </ul>
            </div>
          <% } %>

          <% if (keywordState.success) { %>
            <div class="feedback success"><%= keywordState.success %></div>
          <% } %>

          <% if (keywordState.info) { %>
            <div class="feedback info"><%= keywordState.info %></div>
          <% } %>
        </section>

        <a class="leaderboard-link" href="/leaderboard">View leaderboard â†’</a>
      <% } else { %>
        <h1>Start your Kahnquest</h1>
        <p>This is a fun side-quest you can do for our POWER HOUR. It is definitely NOT knock-off of Konquest. We would never do that. That's plagarizing. That being said...Create an account to unlock the full experience, or log in if you already have one.</p>
        <div class="cta">
          <a class="btn btn-primary" href="/auth/register">Create account</a>
          <a class="btn btn-secondary" href="/auth/login">Log in</a>
        </div>
      <% } %>
    </main>
  </body>
</html>
